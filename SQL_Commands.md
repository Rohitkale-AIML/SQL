## Commands work for PostgreSQL

**Create database using below command:**
```SQL:
CREATE DATABASE BANKING;
```

**Create table using below command:**
```SQL:
CREATE TABLE customers
(
 CUSTOMER_ID	VARCHAR(20) PRIMARY KEY,
 FIRST_NAME	VARCHAR(50) NOT NULL,
 LAST_NAME	VARCHAR(50) NOT NULL,
 PHONE_NO	BIGINT,
 ADDRESS	VARCHAR(50),
 DOB		DATE,
 IS_ACTIVE	VARCHAR(5)
);

CREATE TABLE branch
(
 BRANCH_NAME	VARCHAR(50),
 BRANCH_CODE	VARCHAR(10) UNIQUE
);

CREATE TABLE accounts
(
 ACCOUNT_NUMBER	    BIGINT,
 ACC_TYPE           VARCHAR(30) CHECK (ACC_TYPE IN ('Loan', 'Saving')),
 CUST_ID	    VARCHAR(20),
 BALANCE	    FLOAT,
 constraint pk_acc PRIMARY KEY (ACCOUNT_NUMBER),
 constraint fk_acc FOREIGN KEY (CUST_ID) REFERENCES customers(CUSTOMER_ID)
);

CREATE TABLE transactions
(
 TRNS_ID	INT GENERATED BY DEFAULT AS IDENTITY,
 TRNS_TYPE	VARCHAR(20) CHECK (TRNS_TYPE IN ('wire transfer', 'card transaction', 'net banking')),
 TRNS_DATE	DATE,
 ACC_NUMBER	BIGINT REFERENCES accounts(ACCOUNT_NUMBER),
 AMOUNT		FLOAT,
 STATUS		VARCHAR(10) DEFAULT 'Success'
 constraint pk_acc PRIMARY KEY (TRNS_ID, TRNS_TYPE)
);

CREATE TABLE employees
(
 EMP_ID		VARCHAR(20) PRIMARY KEY,
 FIRST_NAME	VARCHAR(50) NOT NULL,
 LAST_NAME	VARCHAR(50) NOT NULL,
 SALARY		FLOAT ,
 BRANCH_CODE	VARCHAR(10) REFERENCES branch(BRANCH_CODE)
);
```

**Alter column name using below command:** 
```SQL:
ALTER TABLE customers 
RENAME COLUMN id TO cust_id;
```

**Alter column datatype using below command:**
```SQL:
ALTER TABLE customers 
ALTER COLUMN acc_no TYPE BIGINT;
```

**Add new column using below command:**
```SQL:
ALTER TABLE customers
ADD aadhar BIGINT;
```

**Drop a column using below command:**
```SQL:
ALTER TABLE customers
DROP COLUMN aadhar;
```

**Alter table name using below command:**
```SQL:
ALTER TABLE customers 
RENAME TO customers_new;
```

**Drop table using below command:**
```SQL:
DROP TABLE [IF EXISTS] customers [CASCADE | RESTRICT];
```

**Insert records in table use below command:**
```SQL:
INSERT INTO customers (customer_id, first_name, last_name, phone_no, address, dob, is_active) 
VALUES ('C1', 'Lek', 'Toon', null, '77 Lien Park', to_date('19-09-1984','dd-mm-yyyy'), 'true');

INSERT INTO branch 
VALUES ('Bangalore', 'BR1');

INSERT INTO accounts (account_number, acc_type, cust_id, balance) 
VALUES ('6289453270', 'Loan', 'C1', 2874.58);

INSERT INTO transactions (trns_id, trns_type, trns_date, acc_number, amount, status) 
VALUES (1, 'wire transfer', to_date('14-07-2018','dd-mm-yyyy'), '6289453270', 7347.05, 'Success');

INSERT INTO employees (emp_id, first_name, last_name, salary, branch_code) 
VALUES ('E1', 'Jelene', 'Diggin', 39000, 'BR1');

COMMIT;
```

**To update a record in a table:**
```SQL:
UPDATE transactions
SET amount = 999, trns_date = TO_DATE('01-01-2020', 'dd-mm-yyyy')
WHERE trns_id = 1;
```

**To delete records from table:**
```SQL:
DELETE FROM transactions
WHERE trns_id = 1;
```

**Truncate records in a table:**
```SQL:
TRUNCATE TABLE transactions;
```

**How commit, rollback and savepoint used:**
```SQL:
DELETE FROM transactions
WHERE trns_id = 100;

ROLLBACK; -- similar to undo. Removes the uncommitted transactions from the current session

BEGIN;
SAVEPOINT after_2_trns;
END;

COMMIT;

BEGIN;
ROLLBACK TO after_2_trns;
END;
```

**To see table_schema in database use below command:**
```SQL:
SELECT *
FROM information_schema.tables
WHERE table_schema IN ('public', 'dev');
```

**Create view using below command:**
```SQL:
CREATE VIEW vw_customers AS(
SELECT CUSTOMER_ID, FIRST_NAME, LAST_NAME
FROM customers);
```

**Create new user roll using below command:**
```SQL:
CREATE ROLL roll_name
LOGIN login_userID
PASSWORD 'XXXXXXXXX';
```

**Grant or revoke access to any object:**
```SQL:
GRANT privilege_list | ALL 
ON  table_name
TO  role_name;

REVOKE privilege_list | ALL 
ON  table_name
TO  role_name;

-- grants all privileges on all tables in the public schema
GRANT ALL
ON ALL TABLES
IN SCHEMA "public"
TO role_name;
```

*privilege_list: SELECT, INSERT, UPDATE, DELETE, TRUNCATE, etc.*
